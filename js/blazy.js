!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.Blazy=e()}(this,function(){"use strict";var t,e,o,n,i="src",s="srcset";return function(i){if(!document.querySelectorAll){var s=document.createStyleSheet();document.querySelectorAll=function(t,e,o,n,i){for(i=document.all,e=[],o=(t=t.replace(/\[for\b/gi,"[htmlFor").split(",")).length;o--;){for(s.addRule(t[o],"k:v"),n=i.length;n--;)i[n].currentStyle.k&&e.push(i[n]);s.removeRule(0)}return e}}var c=this,l=c._util={};l.elements=[],l.destroyed=!0,c.options=i||{},c.options.error=c.options.error||!1,c.options.offset=c.options.offset||100,c.options.root=c.options.root||document,c.options.success=c.options.success||!1,c.options.selector=c.options.selector||".b-lazy",c.options.separator=c.options.separator||"|",c.options.containerClass=c.options.container,c.options.container=!!c.options.containerClass&&document.querySelectorAll(c.options.containerClass),c.options.errorClass=c.options.errorClass||"b-error",c.options.breakpoints=c.options.breakpoints||!1,c.options.loadInvisible=c.options.loadInvisible||!1,c.options.successClass=c.options.successClass||"b-loaded",c.options.validateDelay=c.options.validateDelay||25,c.options.saveViewportOffsetDelay=c.options.saveViewportOffsetDelay||50,c.options.srcset=c.options.srcset||"data-srcset",c.options.src=t=c.options.src||"data-src",n=Element.prototype.closest,o=window.devicePixelRatio>1,(e={}).top=0-c.options.offset,e.left=0-c.options.offset,c.revalidate=function(){r(c)},c.load=function(t,e){var o=this.options;t&&void 0===t.length?f(t,e,o):T(t,function(t){f(t,e,o)})},c.destroy=function(){var t=c._util;c.options.container&&T(c.options.container,function(e){E(e,"scroll",t.validateT)}),E(window,"scroll",t.validateT),E(window,"resize",t.validateT),E(window,"resize",t.saveViewportOffsetT),t.count=0,t.elements.length=0,t.destroyed=!0},l.validateT=z(function(){a(c)},c.options.validateDelay,c),l.saveViewportOffsetT=z(function(){b(c.options.offset)},c.options.saveViewportOffsetDelay,c),b(c.options.offset),T(c.options.breakpoints,function(e){if(e.width>=window.screen.width)return t=e.src,!1}),setTimeout(function(){r(c)})};function r(t){var e=t._util;e.elements=function(t){for(var e=[],o=t.root.querySelectorAll(t.selector),n=o.length;n--;e.unshift(o[n]));return e}(t.options),e.count=e.elements.length,e.destroyed&&(e.destroyed=!1,t.options.container&&T(t.options.container,function(t){C(t,"scroll",e.validateT)}),C(window,"resize",e.saveViewportOffsetT),C(window,"resize",e.validateT),C(window,"scroll",e.validateT)),a(t)}function a(t){for(var e=t._util,o=0;o<e.count;o++){var n=e.elements[o];(c(n,t.options)||y(n,t.options.successClass))&&(t.load(n),e.elements.splice(o,1),e.count--,o--)}0===e.count&&t.destroy()}function c(t,o){var i=t.getBoundingClientRect();if(o.container&&n){var s=t.closest(o.containerClass);if(s){var r=s.getBoundingClientRect();if(l(r,e)){var a=r.top-o.offset,c=r.right+o.offset,f=r.bottom+o.offset,u=r.left-o.offset;return l(i,{top:a>e.top?a:e.top,right:c<e.right?c:e.right,bottom:f<e.bottom?f:e.bottom,left:u>e.left?u:e.left})}return!1}}return l(i,e)}function l(t,e){return t.right>=e.left&&t.bottom>=e.top&&t.left<=e.right&&t.top<=e.bottom}function f(e,n,r){if(!y(e,r.errorClass)){var a=e.offsetWidth>0&&e.offsetHeight>0;if(!y(e,r.successClass)&&(n||a||("function"==typeof r.loadInvisible?r.loadInvisible(e,a):r.loadInvisible))){var c=m(e,t)||m(e,r.src);if(c){var l=c.split(r.separator),f=l[o&&l.length>1?1:0],v=m(e,r.srcset),h=function(t,e){var o,n,i=m(t,"data-bs-srcset");if(!i)return e;if(!(i=JSON.parse(i))||!i.sizes)return e;o=t.hasAttribute("width")?parseInt(m(t,"width")):t.offsetWidth;(function(){if(window.matchMedia){var t=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");return t&&t.matches||window.devicePixelRatio>1}})()&&(o*=2);for(n in i.sizes)if(parseInt(n)>=o)return i.baseurl+i.sizes[n];if(parseInt(n)<o)return i.baseurl+i.sizes[n];return e}(e,!1);h&&(v=void 0,f=h);var b=w(e,"img"),z=e.parentNode,x=z&&w(z,"picture");if(b||void 0===e.src){var I=new Image,k=function(){r.error&&r.error(e,"invalid"),g(e,r.errorClass),E(I,"error",k),E(I,"load",A)},A=function(){b?x||p(e,f,v):e.style.backgroundImage='url("'+f+'")',u(e,r),E(I,"load",A),E(I,"error",k)};x&&(I=e,T(z.getElementsByTagName("source"),function(t){d(t,s,r.srcset)})),C(I,"error",k),C(I,"load",A),p(I,f,v)}else e.src=f,u(e,r)}else w(e,"video")?(T(e.getElementsByTagName("source"),function(t){d(t,i,r.src)}),e.load(),u(e,r)):(r.error&&r.error(e,"missing"),g(e,r.errorClass))}}}function u(t,e){g(t,e.successClass),e.success&&e.success(t),h(t,e.src),h(t,e.srcset),T(e.breakpoints,function(e){h(t,e.src)}),"function"==typeof e.itemLoaded&&e.itemLoaded.call(t,e)}function d(t,e,o){var n=m(t,o);n&&(v(t,e,n),h(t,o))}function p(t,e,o){o&&v(t,s,o),t.src=e}function v(t,e,o){t.setAttribute(e,o)}function m(t,e){return t.getAttribute(e)}function h(t,e){t.removeAttribute(e)}function w(t,e){return t.nodeName.toLowerCase()===e}function y(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function g(t,e){y(t,e)||(t.className+=" "+e)}function b(t){e.bottom=(window.innerHeight||document.documentElement.clientHeight)+t,e.right=(window.innerWidth||document.documentElement.clientWidth)+t}function C(t,e,o){t.attachEvent?t.attachEvent&&t.attachEvent("on"+e,o):t.addEventListener(e,o,{capture:!1,passive:!0})}function E(t,e,o){t.detachEvent?t.detachEvent&&t.detachEvent("on"+e,o):t.removeEventListener(e,o,{capture:!1,passive:!0})}function T(t,e){if(t&&e)for(var o=t.length,n=0;n<o&&!1!==e(t[n],n);n++);}function z(t,e,o){var n=0;return function(){var i=+new Date;i-n<e||(n=i,t.apply(o,arguments))}}});